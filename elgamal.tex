\section{El Gamal Encryption}

\label{sec:elgamal} 

In this section, we proceed to describe a clever but efficient public key encryption scheme called \textit{El Gamal encryption} \cite{Elgamal_1985}. 
However, before diving into the details of the scheme, we provide a brief overview of necessary definitions and theorems in group theory.

\subsection{An overview of Group theory}

\cite{koocmsc} defines an Abelian group $ \mathcal{G} $ as

\begin{definition}
An Abelian group $ \mathcal{G} $ is a finite set of elements along with an operation $ * $ such that:

\begin{itemize}
    \item \textbf{Closure} For all $ a, b \in \mathcal{G} $ we have $ a * b \in \mathcal{G} $. We use $ a * b $ as $ ab $ henceforth for brevity.
    \item \textbf{Associativity} $ \forall a, b, c \in \mathcal{G} $, $ (ab)c = a(bc) $.
    \item \textbf{Commutativity} $ \forall a, b \in \mathcal{G} $, $ ab = ba $.
    \item \textbf{Existence of identity} $ \exists $ an element $ 1 \in \mathcal{G} $ such that $ 1 * a = a $ $ \forall a \in \mathcal{G} $. This element is the identity of $ \mathcal{G} $.
    \item \textbf{Inverse} $ \forall a \in \mathcal{G}$, $ \exists $ an element $ a^{-1} \in \mathcal{G} $ such that $ aa^{-1} = 1 $.
\end{itemize}
\end{definition}

\begin{theorem}
Let $\mathcal{G}$ be a finite Abelian group of order $ q $. Then $ a^q = 1 $ for all a $\in \mathcal{G}$.
\end{theorem}

\begin{proof}

Taken from \cite{koocmsc}.

Let us take $ a_1, \ldots a_q $ to be the elements of $\mathcal{G}$ and let $ a \in \mathcal{G} $ be some arbitrary element. We note that the sequence of elements $ aa_1, aa_2, \ldots , aa_q $ also contains exactly the elements of group $ \mathcal{G} $. Therefore:

\begin{equation*}
\begin{split}
a_1 \cdot a_2 \cdot \cdot \cdot a_q
&= (aa_1) \cdot (aa_2) \cdot \cdot \cdot (aa_q)\\
&= a^q (a_1 \cdot a_2 \cdot \cdot \cdot a_q)
\end{split}
\end{equation*}

On multiplying both sides by $ (a_1 \cdot \cdot \cdot a_q)^{-1} $, we get 

\begin{equation*}
a^q = 1
\end{equation*}
\end{proof}

\begin{corollary}
Let $ \mathcal{G} $ be a finite Abelian group of order $ q $, and let $ n $ be a positive integer.
Then $ g^n = g^{n \mod q} $.
\end{corollary}

\begin{proof}

Taken from \cite{koocmsc}.

Let us write $ n = n_q \mod q $ so that $ n $ can be further written as $ n = aq + n_q $ for some $ a \in \mathbb{Z} $. Then, we have

\begin{equation*}
g^n = g^{aq+n_q} = (g^a)^q g^{n_q} = g^{n_q}
\end{equation*}
\end{proof}

\begin{lemma}
If $ \mathcal{G} $ is an Abelian group with prime order $ q $, then 
\begin{enumerate}
    \item $ \mathcal{G} $ is cyclic; furthermore,
    \item every element of $ \mathcal{G} $ (except the identity) is a generator.
\end{enumerate}
\end{lemma}

\subsection{Discrete Logarithm Problem}

The problem can be described as follows: given a generator $ g $ of group $ \mathcal{G} $ and a random element $ h \in \mathcal{G} $, compute $ \log_g h $.

A common reference is made to the \textit{discrete logarithm assumption}, which says that for most groups, the discrete logarithm problem is ``hard".

\subsection{Description of El Gamal}

We proceed to describe the El Gamal encryption scheme which is based on the Diffie-Hellman Key agreement scheme.

\smallskip

% After the necessary overview, we go ahead and describe the El Gamal encryption scheme whose security is closely related to the discrete logarithm assumption:

\begin{algorithmic}
\STATE {\textbf{Key generation} \textsc{Gen}($ 1^k $):}
\STATE ($ \mathcal{G} $, $ q $, $ g $) $ \leftarrow \textsc{GroupGen} (1^k) $ 
\STATE Choose $ x \leftarrow \mathbb{Z}_q $; set $ y = g^x $ 
\STATE Output $ PK = ( \mathcal{G}, q, g, y) $ and $ SK = x $ 
\end{algorithmic} 

\smallskip

\begin{algorithmic}
\STATE {\textbf{Encryption} $ \mathcal{E}_{pk} (m) $ (where $ m \in \mathcal{G} $)}
\STATE Pick $ r \leftarrow \mathbb{Z}_q $ 
\STATE Output $ \langle g^r, y^r m \rangle $ 
\end{algorithmic} 

\smallskip

\begin{algorithmic}
\STATE {\textbf{Decryption} $ \mathcal{D}_{sk} (A, B) $}:
\STATE Compute $ m = \frac{B}{A^x} $ 
\end{algorithmic}

The correctness of the decryption process follows from,

\begin{equation*}
\frac{y^r m}{(g^r)^x} = \frac{y^r m}{(g^x)^r} = \frac{y^r m }{y^r} = m
\end{equation*}

\subsubsection{Security}


\subsection{Decisional Diffie-Hellman (DDH) Assumption}
